<!DOCTYPE html>
<html>
<head>
 <title>MULLE (MUSTE Language Learning Environment)</title>
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link rel="stylesheet" href="/css/muste.css" />
 <script defer type="text/javascript" src="/js/jquery.min.js"></script>
 <script defer type="text/javascript" src="/js/handlebars.min.js"></script>
 <script defer type="text/javascript" src="/js/countdown.js"></script>
 <script defer type="text/javascript" src="/js/app.js"></script>
</head>

<body>
 <main>
  <span id="busy-indicator" class="idle">&#9679;</span>
  <div hidden class="overlay"></div>


  <!-- PAGE: LOGIN -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-login">
   <div class="title">
     <h1>MULLE</h1><strong>(MUSTE Language Learning Environment)</strong>
   </div>
   <div class="container">
    <form id="loginform" method="post">
     <div>
      <div><h3>Användare:</h3></div>
      <div><input type="text" name="name"></div>
     </div>
     <div>
      <div><h3>Lösenord:</h3></div>
      <div><input type="password" name="pwd"></div>
     </div>
     <div class="spaced">
      <button type="submit">Login</button>
     </div>
    </form>
    <hr />
    <button data-pager="#page-create-user">Create new user</button>
    <button data-pager="#page-change-password">Change password</button>
   </div>
   <div></div>
  </div>


  <!-- PAGE: LESSONS -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-lessons">
   <div>
    <span class="right">
     <button data-pager="#page-high-scores" onclick="fetch_high_scores()">High scores</button>
     <button id="logoutbutton">Logga ut</button>
    </span>
    <div class="title">
      <h1>MULLE</h1><strong>(MUSTE Language Learning Environment)</strong>
    </div>
   </div>
   <div>
    <div class="container" id="lessonslist"></div>

     <!-- Handlebars templates should be put insive <script> tags -->
     <script id="lesson-list-template" type="text/x-handlebars-template">
       <div class="lessons">
	 {{#each .}}
	 <div class="{{#if (or passed (gte passed total))}}finished{{/if}} {{#if enabled}}{{else}}disabled{{/if}}">
	   <div class="lesson-info">
	     <div>
	       <h3>{{name}}</h3>
	       <p>
		 {{passedcount}} avklarade av {{exercisecount}} övningar
	       </p>
	       {{#if score}} 
	       <p> 
		 Your score so far: <span>{{score.clicks}} klick i {{score.time}} sekunder</span> 
		 <canvas class="score" data-lesson="{{lesson}}" data-score="{{json score}}"></canvas>
	       </p> 
	       {{/if}} 
	       <p>
		 {{description}}
	       </p>
	     </div>
	     <div class="lesson-info-button"> 
	       <button {{#if (or passed (not enabled))}}disabled{{/if}} onclick="start_lesson({{lesson}});">Solve</button> 
	       {{#if passed}}<button onclick="restart_lesson({{lesson}});">Restart</button>{{/if}} 
	     </div> 
	   </div>
	 </div>
	 {{/each}}
       </div>
     </script>

   </div>
   <div class="vertical-separator"></div>
   <div>
    <a class="button left instructions button" href="instructions.html" target="_blank">Instructions</a>
   </div>
  </div>


  <!-- PAGE: EXERCISE -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-exercise">
   <div>
    <span class="left" id="lessoncounter"></span>
    <button class="right" id="abortlesson">Avbryt lektion</button>
   </div>

   <div class="container container-alt">
    <div class="exercise">
     <div id="src" class="sentence prevent-body-click"></div>
     <div class="vertical-separator"></div>
     <div id="trg" class="sentence prevent-body-click"></div>
    </div>
   </div>

   <div>
    <!-- <div id="score" class="left"> -->
    <!--  Score: Time: <span id="score-time"></span>. Clicks: <span id="score-clicks"></span> -->
    <!-- </div> -->
    <span class="right">Elapsed time: <span id="timer"></span></span>
    <div hidden class="popup menu prevent-body-click" id="menus"></div>
    <div hidden class="popup error"></div>
   </div>
  </div>


  <!-- PAGE: CREATE USER -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-create-user">
   <div class="title">
    <h1>Create user</h1>
   </div>
   <div class="container">
    <form action="create-user" method="post">
     <div>
      <div><h3>Användare:</h3></div>
      <div><input type="text" name="name" required></div>
     </div>
     <div>
      <div><h3>Lösenord:</h3></div>
      <div><input type="password" name="pwd" required></div>
     </div>
     <div>
      <div><h3>Gentag lösenord:</h3></div>
      <div><input type="password" name="confirm-pwd" required></div>
     </div>

     <div class="spaced">
      <button type="submit">Create user</button>
     </div>
    </form>
    <hr />
    <button data-pager="#page-login">Log in with existing user</button>
   </div>
   <div></div>
  </div>


  <!-- PAGE: CHANGE PASSWORD -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-change-password">
   <div class="title">
    <h1>Skift lösenord</h1>
    <pre>TODO Maybe this should only be accessible when the user is logged in.  In that case we don't have to ask for the old password.</pre>
   </div>
   <div class="container">
    <form action="change-pwd" method="post">
     <div>
      <div><h3>Användare:</h3></div>
      <div><input type="text" name="name" required></div>
     </div>
     <div>
      <div><h3>Gammalt lösenord:</h3></div>
      <div><input type="password" name="old-pwd" required></div>
     </div>
     <div>
      <div><h3>Nya lösenord:</h3></div>
      <div><input type="password" name="pwd" required></div>
     </div>
     <div>
      <div><h3>Gentag nya lösenord:</h3></div>
      <div><input type="password" name="confirm-pwd" required></div>
     </div>

     <div class="spaced">
      <button type="submit">Skift lösenord</button>
     </div>
    </form>
    <hr />
    <button data-pager="#page-login">Log in with existing user</button>
   </div>
   <div></div>
  </div>


  <!-- PAGE: HIGH SCORES -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -->

  <div class="page" id="page-high-scores">
   <div>
    <div class="right">
     <button data-pager="#page-lessons">Show lessons</button>
    </div>
    <div class="title">
      <h1>High scores</h1>
    </div>
   </div>
   <div class="container">
    <table>
     <thead>
      <tr>
       <td>Lesson</td>
       <td>User</td>
       <td>Score - clicks</td>
       <td>Score - time</td>
      </tr>
     </thead>
     <tbody id="high-scores-table">
     </tbody>
    </table>

     <!-- Handlebars templates should be put insive <script> tags -->
     <script id="high-scores-template" type="text/x-handlebars-template">
       {{#each .}}
       <tr>
	 <td>{{lesson.name}}</td>
	 <td>{{user.name}}</td>
	 <td>{{score.clicks}}</td>
	 <td>{{score.time}}</td>
       </tr>
       {{/each}}
     </script>

   </div>
   <div></div>
  </div>

 </main>
</body>
</html>
